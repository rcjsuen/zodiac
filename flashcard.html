<html>
  <head>
    <meta charset="utf-8" />
    <title>Zodiac - Time Trial</title>
    <style>
		body {
	    	background: #333333;
	    }
	    
	    canvas { display: block; margin: 0 auto; }
	      
		.setup {
		    position: absolute;
		    top: 50%;
		    left: 50%;
		    -moz-transform: translateX(-50%) translateY(-50%);
		    -webkit-transform: translateX(-50%) translateY(-50%);
		    transform: translateX(-50%) translateY(-50%);
			background: #333333;
		}
	
		.setup > div {
			padding: 20px;
			border-radius: 10px;
			background: -moz-linear-gradient(#fff, #bbb);
			background: -webkit-linear-gradient(#fff, #bbb);
			background: -o-linear-gradient(#fff, #bbb);
			background: -ms-linear-gradient(#fff, #bbb);
		}
	      
		.countdown {
		    position: absolute;
		    top: 50%;
		    left: 50%;
		    width: 250;
		    -moz-transform: translateX(-50%) translateY(-50%);
		    -webkit-transform: translateX(-50%) translateY(-50%);
		    transform: translateX(-50%) translateY(-50%);
			background: #333333;
		}
	
		.countdown > div {
			text-align: center;
			font-family: Calibri, Arial, Helvetica, Sans;
			font-size: 200;
			border-radius: 150px;
			background: -moz-linear-gradient(#fff, #bbb);
			background: -webkit-linear-gradient(#fff, #bbb);
			background: -o-linear-gradient(#fff, #bbb);
			background: -ms-linear-gradient(#fff, #bbb);
		}
		
		.flip {
			-webkit-perspective: 800;
			width: 400px;
			height: 200px;
			position: relative;
			margin: 25px auto;
		}

		.flip .card.flipped {
			transform: rotatex(-180deg);
			-moz-transform: rotatex(-180deg);
			-webkit-transform: rotatex(-180deg);
		}
		
		.flip .card {
			width: 100%;
			height: 100%;
			transform-style: preserve-3d;
			-webkit-transform-style: preserve-3d;
			transition: 0.5s;
			-webkit-transition: 0.5s;
		}

		.flip .card .face {
			border-style: solid;
			width: 100%;
			height: 100%;
			position: absolute;
			font-family: Calibri;
			font-size: 3em;
			text-align: center;
		}
		
		.flip .card .front {
			border-style: solid;
			position: absolute;
		}
		
		.flip .card .back {
			border-style: solid;
			transform: rotatex(-180deg);
			-webkit-transform: rotatex(-180deg);
		}
    </style>
  </head>
  <body id="body">

<div id="content" style="display: none;">

<center>

<p/>
<font face="Calibri">
<p id="remaining"></p>
</font>

<div class="flip"> 
    <div id="card" class="card"> 
        <div class="face front" id="front">
        	<table bgcolor="#ffffff" height="200" width="400" id="frontTable">
        		<tr>
        			<td><p align="center" id="frontContent"></p></td>
        		</tr>
        	</table>
		</div> 
        <div class="face back" id="back">
        	<table bgcolor="#ffffff" height="200" width="400" id="backTable">
        		<tr>
        			<td><p align="center" id="backContent"></p></td>
        		</tr>
        	</table>
        </div>
    </div> 
</div> 

<input id="input" disabled/>
<button id="nextBtn" type="button" onClick="onClick()" disabled>次へ</button>
<p/>

<canvas id="canvas" width=710" height="290"></canvas>
<p id="mistake"></p>
<p/>


</center>
</div>

<div id="openModal" class="setup">
	<div>
		<img src="images/logo.png"/><p/>
		<p align="right"><font face="Calibri, Arial, Helvetica, Bitstream Sans">© 2015 Remy Suen</font></p>
		<hr/>
		<input type="file" id="files" multiple/><p/>
		<input type="checkbox" id="timeCheckbox" onClick="toggleTimeTrial()">時間制限</input>
		<input type="number" id="time" disabled/><p/>
		<input type="checkbox" state="true" id="keyboardChk" checked="true" onClick="showKeyboard()">バーチャルキーボード</input><p/>
		<p align="center"><button id="startBtn" type="button" onClick="startCountdown()" disabled>スタート</button></p>
	</div>
</div>

<div id="countdown" class="countdown" style="display: none">
	<div>
		<p id="countdownText">5</p>
	</div>
</div>

<script src="keyboard.js"></script>
<script src="zodiac.js"></script>
<script>
var countdownTime = 5;
var remainingTime = -1;

function startCountdown() {
	// hide the setup popup
	document.getElementById("openModal").style.display = "none";

	if (document.getElementById("timeCheckbox").checked) {
		// show the timer
		document.getElementById("countdown").style.display = "inline";
		setTimeout(countdown, 1000);
	} else {
		// not a time trial, remove the field for showing the remaining time
		document.getElementById("remaining").style.display = "none";
		// enable the input field and grant it focus
		document.getElementById("input").disabled = false;
		document.getElementById("input").focus();
	}
}

function countdown() {
	countdownTime--;
	document.getElementById("countdownText").innerHTML = countdownTime;
	if (countdownTime === 0) {
		// show the content
		document.getElementById("body").style.background = "#ffffff";
		document.getElementById("content").style.display = "inline";
		// hide the countdown timer
		document.getElementById("countdown").style.display = "none";
		// enable the input field and grant it focus
		document.getElementById("input").disabled = false;
		document.getElementById("input").focus();
		
		startTimeTrial();
	} else {
		setTimeout(countdown, 1000);
	}
}

function startTimeTrial() {
	remainingTime = parseInt(document.getElementById("time").value, 10);
	
	document.getElementById("remaining").innerHTML = remainingTime + "秒";
	setTimeout(timer, 1000);
}

function timer() {
	remainingTime--;
	document.getElementById("remaining").innerHTML = remainingTime + "秒";
	if (remainingTime === 0) {
		alert("もう時間だ！");
	} else {
		setTimeout(timer, 1000);
	}
}

function toggleTimeTrial() {
	document.getElementById("time").disabled = !document.getElementById("timeCheckbox").checked;
}

var enableKeyboard = true;

function showKeyboard() {
	enableKeyboard = !enableKeyboard;

	if (enableKeyboard) {
		document.getElementById("canvas").style.display = "inline";
	} else {
		document.getElementById("canvas").style.display = "none";
	}
}
</script>

</body>
</html>